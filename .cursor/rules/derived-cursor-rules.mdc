---
description: AI rules derived by SpecStory from the project AI interaction history
globs: *
---

## Headers

This document defines the rules and guidelines for the AI coding assistant to follow while working on this project. It covers project structure, coding standards, workflow, and best practices. This file is a living document and will be updated as the project evolves.

## Project Description

The AI coding assistant is working on a multilingual code generation library named "Coder". This library aims to provide a flexible and extensible way to represent code in an Abstract Syntax Tree (AST) format, serialize and deserialize the AST to YAML, and generate code in various programming languages from the AST.

## TECH STACK

- .NET 7 or later
- YamlDotNet (for YAML serialization and deserialization)
- .NET 9 (identified during build process)

## PROJECT DOCUMENTATION & CONTEXT SYSTEM

- Implementation Plan: `docs/implementation-plan.md`

## CODING STANDARDS

- Follow .NET coding conventions.
- Use meaningful names for variables, methods, and classes.
- Write clear and concise code with comments where necessary.
- Apply DRY (Don't Repeat Yourself) principle.
- Handle errors gracefully with appropriate exception handling.
- Write unit tests for all components.
- Use dependency injection to promote loose coupling.
- All files must include a copyright notice.
- Implement the `Clone()` method properly in AST node classes, ensuring derived classes `override` it.
- Address code analysis warnings and errors identified during build processes (e.g., CS8852, IDE2003, CA1502, IDE0010).

## DEBUGGING

- Use the debugger to step through code and inspect variables.
- Write unit tests to isolate and fix bugs.
- Use logging to track the flow of execution and identify issues.
- Address code analysis warnings, such as those related to cyclomatic complexity, by refactoring code into smaller, more manageable methods.
- Analyze and fix compilation errors reported by the .NET build process.

## WORKFLOW & RELEASE RULES

- Create a new branch for each feature or bug fix.
- Submit a pull request for review before merging into the main branch.
- All pull requests must pass unit tests and code review.
- Use semantic versioning for releases.

## AST RULES

- The AST should be language-agnostic.
- AST nodes should be serializable and deserializable.
- Implement a `Clone()` method for all AST nodes to enable deep copying.
- The `Metadata` property in `AstNode` and derived classes should have a `protected init` setter to allow setting during object initialization in derived classes and prevent modification after initialization.
- Ensure that deserialization logic respects the `protected init` setter of the `Metadata` property in `AstNode` and derived classes. Refactor deserialization logic if necessary to correctly initialize this property.